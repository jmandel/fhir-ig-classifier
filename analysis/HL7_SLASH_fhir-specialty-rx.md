# fhir-specialty-rx: Analysis

## Core Purpose & Scope

This FHIR Implementation Guide (IG) addresses the lack of standardization in exchanging patient demographic, clinical, consent, and coverage data needed for fulfilling specialty medication prescriptions and enrolling patients in related support programs. It solves the problem of manual, inefficient processes that delay patient access to specialty therapies by defining a standardized, FHIR-based approach for sharing this information between prescribers, pharmacies, specialty hubs, and pharmaceutical manufacturers. The IG's scope is limited to information exchange supporting specialty medication fulfillment and does not cover the transmission of the prescription itself (typically handled by NCPDP SCRIPT in the US). It is intended for use within the United States healthcare system.

## Technical Foundation

The IG is built on FHIR R4 and leverages both RESTful interactions and FHIR messaging. Core profiles include `SpecialtyRxPatient`, `SpecialtyRxMedicationRequest`, `SpecialtyRxOrganizationPharmacy`, `SpecialtyRxPractitioner`, `SpecialtyRxCoverage`, `SpecialtyRxConsent`, `SpecialtyRxConsentRequested`, `SpecialtyRxTaskSmartLaunch`, and `SpecialtyRxTaskConsentRequest`. Key operations include `Patient/$match` and `$process-message`. Notable interactions include RESTful searches (GET and POST) and message exchanges using Bundles with MessageHeaders. The IG defines several code systems and value sets, including `specialty-rx-event-type`, `specialty-rx-task-characteristic`, `specialty-rx-task-type`, `specialty-rx-task-input-type`, and `specialty-rx-task-output-type`. Significant patterns include the use of searchset Bundles to return search results, the use of Parameters resources to convey request and response details in messages, and the use of Task resources to manage human-involved workflows.

## Technical Essence

This IG defines a FHIR-based framework for exchanging specialty medication fulfillment data, supporting both RESTful and messaging paradigms. It defines two primary workflows: "solicited" (pharmacy requests data) and "unsolicited" (prescriber proactively sends data). For solicited workflows, Data Consumers can either pre-match the patient using `Patient/$match` or defer matching to the Data Source. Requests are made via RESTful searches or a `SpecialtyRxQuery` message (event type `query`) containing a Parameters resource with `query-string` parameters specifying searches (e.g., `Condition?patient=[id]`). Responses use a `SpecialtyRxQueryResponse` message (event type `query-response`) with a Parameters resource containing `search-result` parameters, each a searchset Bundle. Unsolicited workflows use a `SpecialtyRxQueryResponseUnsolicited` message (event type `query-response-unsolicited`).  Error handling leverages OperationOutcome resources. Consent workflows are supported via `SpecialtyRxConsent` and `SpecialtyRxConsentRequested` profiles, with requests managed through `SpecialtyRxTaskConsentRequest` tasks. Human-in-the-loop interactions are facilitated by `SpecialtyRxTaskSmartLaunch` tasks, triggering SMART app launches with context passed via `Task.identifier` and OAuth 2.0 `__appContext`.

## Implementation Approach

Implementers can choose between RESTful and messaging approaches, or both. Data Sources must support at least one of the defined CapabilityStatements. Critical workflows include the solicited query/response and the unsolicited push of patient data. The IG mandates support for specific search parameters and US Core profiles for certain resources. It defines clear expectations for handling missing data, using `dataAbsentReason` extensions where appropriate. The design emphasizes compatibility with existing NCPDP SCRIPT-based prescription transmission and allows for intermediary facilitation of exchanges between RESTful and messaging-based systems. The Task resource is used to manage requests for human interaction, including SMART app launches and consent requests.

## Ecosystem Context

The primary target systems are EHRs used by prescribers and systems used by pharmacies, specialty hubs, and pharmaceutical manufacturers involved in specialty medication fulfillment. The IG is designed to complement the NCPDP SCRIPT standard for electronic prescribing and leverages US Core profiles for baseline data elements. It is intended for use within the United States and addresses the specific needs of the US specialty pharmacy market. Key use cases include retrieving patient clinical data to support dispensing, billing, and enrollment in patient support programs, as well as obtaining and sharing patient consents and other authorizations required for specialty product fulfillment.

# ccda-on-fhir: Analysis

## Core Purpose & Scope

This Implementation Guide (IG) aims to bridge the gap between Consolidated CDA (C-CDA) 2.1 and FHIR R4, specifically US Core, by defining FHIR profiles and mappings to represent C-CDA documents and their clinical content. It primarily addresses the interoperability challenges arising from the widespread use of C-CDA in the US healthcare system and the growing adoption of FHIR. The IG solves key clinical and business problems related to exchanging clinical summaries, care plans, and other essential documents by enabling the transformation of C-CDA documents into FHIR resources and vice-versa. The scope is initially focused on representing C-CDA document types using FHIR Composition profiles and mapping core clinical domains (Problems, Allergies, Medications, Immunizations, Procedures, and Patient - PAMI+) between C-CDA templates and FHIR resources. The IG explicitly excludes coded data requirements for sections, adopting a "required if known" approach.

## Technical Foundation

The technical foundation of this IG rests on FHIR R4, leveraging the FHIR Documents paradigm and US Core profiles. It defines a set of **Composition profiles** representing various C-CDA document types, such as Care Plan, Consultation Note, Discharge Summary, and others. These profiles utilize **extensions** to capture C-CDA specific elements not directly represented in FHIR, including Authorization, Informant, Participant, Performer, Data Enterer, Information Recipient, Order, and Version Number. The IG defines **CapabilityStatements** for Document Source and Document Consumer actors. **Key terminology mappings** are provided using ConceptMap resources, translating between C-CDA and FHIR value sets for elements like allergy types, encounter status, immunization status, medication status, and administrative gender. Significant patterns include the use of `Bundle.type = document` to package Composition and referenced resources, the "required if known" approach for coded data, and the reliance on US Core profiles for representing clinical content within Composition sections. Constraints include specific mappings for handling nullFlavors, negation, and time/dates.

## Technical Essence

This IG defines a system for representing C-CDA documents as FHIR Composition resources within a `Bundle` of type `document`. Each C-CDA document type maps to a specific Composition profile, extending the base Composition with US Realm Header elements and defining section structures that mirror C-CDA sections. Each section can contain entries that reference US Core profiles or unprofiled FHIR resources representing clinical data like Allergies, Immunizations, Medications, Problems, and Procedures.  Mappings are defined using a combination of structural guidance and ConceptMaps, addressing challenges like identifier translation (OID to URI), date/time format conversion, and terminology mapping.  Negation is handled through specific mappings, and missing data is addressed using nullFlavors in CDA and dataAbsentReason in FHIR. Provenance is captured using FHIR Provenance resources, referencing the Composition and other resources. The IG provides detailed guidance on mapping specific C-CDA templates to FHIR resources, including handling of coded data, quantities, and narrative text. For example, a C-CDA Allergy Intolerance Observation is mapped to a US Core AllergyIntolerance resource, with specific mappings for clinicalStatus, type, category, criticality, code, onset, and reaction. The IG also defines how to represent a C-CDA Vital Signs Organizer as a FHIR Observation panel with `hasMember` references to individual vital sign Observations.

## Implementation Approach

The IG is intended to be implemented by Document Sources (servers) that expose C-CDA documents and Document Consumers (clients) that consume them. Implementers must conform to the defined Composition profiles, populate Must Support elements, and adhere to the CapabilityStatement expectations. Critical workflows involve querying for documents using the `$document` operation, transforming C-CDA documents to FHIR bundles and vice-versa, and handling terminology mappings. The IG emphasizes the use of US Core profiles for representing clinical data within Composition sections. Key requirements include handling missing data using appropriate nullFlavors or dataAbsentReason, preserving the narrative text from C-CDA sections, and accurately mapping identifiers, dates, times, and coded values. Notable design choices include the "required if known" approach for coded data and the use of extensions to capture C-CDA specific elements.

## Ecosystem Context

The target systems for this IG are primarily EHRs, Health Information Exchanges (HIEs), and other clinical systems operating within the US healthcare ecosystem. The target users are developers and implementers working with these systems. The IG is closely related to C-CDA R2.1, the C-CDA Companion Guide, FHIR R4, and US Core. It is relevant to jurisdictions and programs in the US that rely on C-CDA for clinical data exchange, particularly those transitioning to FHIR. The primary use cases involve the exchange of clinical summaries, care plans, discharge summaries, and other document types for care coordination, transitions of care, and public health reporting. The IG also supports scenarios where systems need to consume both C-CDA and FHIR documents.
